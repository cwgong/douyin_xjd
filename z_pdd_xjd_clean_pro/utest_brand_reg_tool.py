
from brand_reg_tool import BrandRegTool
import tool
import traceback
traceback.format_exc()

# def __init__(self, standard_brand_file, del_brand_file=None, exchange_brand_file=None, rule_brand_file=None):
#
bReg = BrandRegTool("pdd_xjd_brand_recall_info.txt", "pdd_xjd_del_brand_info.txt", \
                    "pdd_xjd_exchange_brand_info.txt", "pdd_xjd_rule_brand.cfg")

idx = 0
err_lst = []
with open("pdd_xjd.txt","r",encoding="utf-8") as f1:
    for line in f1:
        try:
            line = line.strip()
            if line == "": continue
            lst1 = line.split("\001")
            if len(lst1) != 4:
                print(lst1)
                continue

            idx += 1

            lst1 = [tmp.strip() for tmp in lst1]
            product_id, product_name, cat1, cat2 = lst1

            #if product_id not in ["100498212961", "147609411112"]: continue
            #if  product_id not in ['138530686176', '104081369303', '14206245749', '103570137198', '18874096266', '120046461707', '951071325', '99658548351', '97280997590', '134213749183', '57180975292', '14565017694', '37415524562', '1094933101', '146138976868', '486264082', '123368307456', '21078666566', '91005949850', '129593315611', '2014337554', '165305852605', '89493294864', '32675875', '131716255616', '142698028013', '44778877358', '94124066670', '2764652659', '1054783533', '116740139271', '3920460995', '97985870372', '145382573061', '92431946403', '111944349029', '4673022045', '2241163797', '111726240743', '130826069039', '1418945585', '160548695611', '7110554538', '102081520644', '84247861388', '5715161922', '6520916435', '80666998046', '131005046557', '92903931869', '136780509477', '96558724749', '165363650642', '141490488447', '98683342699', '155771418215', '101226265967', '58142863855', '108351109561', '97063317772', '102312934623', '28923064396', '85613510426', '526160022', '99168588308', '149523647250', '100629030661', '111956397173', '155572345261', '123368314342', '9273813585', '3852291475', '111726410298', '84425058064', '104617081565', '120822413355', '7018848149', '140756764347', '1914783625', '8746435617', '62971069548', '131211691226', '141383601005', '7059753201', '2917541690', '102749202632', '62365796317', '121525278447', '116382237003', '119813551948', '126724935759', '133082450402', '123105533901', '6883231721', '173229309023', '140319367646', '81634192268', '129032390214', '1801985229', '114462161291', '101485737207', '102365128711', '102076391559', '7682295976', '134927902513', '95467351170', '107882580293', '28833243560', '98928111021', '8024299310', '69160545567', '140815280389', '6823400069', '107723552343', '104493855877', '2468943251', '1392763818', '142715203878', '120711653401', '6747268527', '140327372143', '51746434696', '112841190831', '144995869500', '5282646926', '147366279312', '171919796453', '130354508467', '98232264679', '24134632528', '44615635784', '121956828999', '156043060368', '127487783271', '3983846828', '102107288117', '84649461629', '5810548347', '135520459417', '146213554202', '2652411621', '6980824264', '114395597489', '153387874396', '5479879598', '84428566579', '137727012090', '104083361418', '1727308409', '49158245997', '129679066031', '137747900285', '30669648776', '148707558721', '111929188985', '143382389034', '113669301966', '119813721488', '724703061', '107163112876', '2789671262', '5946636265', '104081748129', '109714642095', '104655301006', '102746844584', '6090267987', '6477943266', '52818597704', '113661898315', '16288094348', '48301926581', '112340668930', '112360728714', '129033193530', '42512182396', '4190453068', '90138582132', '51036894957', '95687347419', '3086641020', '4716212688', '130857322190', '29921254360', '1007730583', '100917371832', '16280395056', '884099165', '7060527516', '106682048030', '2365012377', '148939162957', '112194907921', '8910273699', '161291826692', '7098178281', '89199342663', '825062355', '59711126182', '290161453']:
            #    continue
            #if product_id not in ['88343582984', '132900392001', '134128237932', '149557678661', '39809100355', '172621049000', '173423883212', '91336419395', '117271890265', '148549239402', '132411621509', '146254196346', '158114958176', '159881220157', '121555533290', '139032708283', '162998113270', '70878514404', '125230005355', '141544036145', '488414006', '158344325926', '144883174770', '110893137272', '155946562998', '50877778383', '7851494921', '136812798095', '121525566914', '93940467254', '165832554340', '106852170746', '170469016122', '173223655704', '146578179551', '55570714853', '153245087229', '2418443457', '102285473593', '101483732313', '175013895159', '186867108', '102425206930', '2647606260', '172349390651', '178112182539', '142177471447', '125721321557', '175413354229', '160036712095', '101518742304', '4821858488', '15353623564', '147287455984', '144897966836', '116307245813', '122083686568', '132988963481', '119630948537', '111978778154', '178103036263', '113508827457', '6426219886', '155786377077', '27320736489', '2222072788', '171963446248', '115389666470', '157654746378', '121324785581', '123780589534', '151519130780', '104811941948', '114035690396', '111617016093', '63715155325', '66561809239', '4087819565', '2646073624', '6101074890', '170263919360', '47680988347', '90934493962', '164895820807', '96030208340', '88810639654', '131837121616', '135453134074', '117017133877', '152409967528', '171527810520', '82243303444', '82108208292', '154625413684', '153384682403', '20122393906', '134920395818', '178967874466', '129357361633', '104812232185', '121798925998', '112386703068', '63163364', '124794772737', '173949581164', '101329439115', '106573161218', '19249993983', '127145804777', '11227528', '25376310664', '133571268584', '260792158', '142161744635', '6208027965', '148123536390', '104043287620', '160036723779', '143398394377', '126812936436', '132917310643', '134886206000', '158974525357', '135270662915', '3017717289', '155884341466', '86796078491', '113845953781', '144850685689', '129112597428', '143550987758', '122299120162', '91347925477', '150551049927', '146090392961', '41208179425', '132996147450', '144997240601', '126659937766', '123333572332', '179297659694', '132992972904', '112246350780', '131460418696', '7698613874', '136559033525', '148428999602', '28654537351', '128952969313', '132914795766', '161633633935', '109581024286', '145710643202', '139557808432', '130863207218', '145808597868', '144734933210', '154850118193', '101649715537', '91499891604', '3378757207', '2411727278', '139671616', '133211923388', '125068508502', '126750006159', '110162129638', '136427929887', '142046320394', '110814657186', '2530547019', '43983378673', '7751196379', '5862685124', '134009476317', '111518353957', '144906951594', '3772574293', '148284507911', '130819424485', '139991322963', '1384738283', '130114758411', '103966292686', '129087892566', '172778039589', '178557252688', '112690051523', '7157520513', '172302827426', '153945018724', '136364234445', '169126146207', '163725009759', '128593443285', '155358248940', '78537888888', '151673266086', '157677287777', '145049979378']:
            #    continue
            #if product_id not in ["148428999602"]: continue
            #if product_id not in ["162285442489", "113164445088", "151134584203"]: continue
            #if product_id not in ['8007929891', '140873563922']: continue

            #if product_id not in ['46930440615', '78914583551', '969637853']: continue
            #if product_id not in ['174118171342', '78914583551', '30882357005']: continue
            #if product_id not in ['103875996179']: continue

            #if product_id not in ['86211027075', '145946086309', '23156086541']: continue
            #if product_id not in ['5260238']: continue
            if product_id not in ['6371218']: continue
            #if product_id not in ['175421754384']: continue
            #if product_id not in ['162124037856', '329575', '192857533461']: continue
            # if product_id not in ['27287759563', '116713619581','94275112971','71840231942','164260532299','102297376058','94401553316','44760474688']: continue

            pre_brand_id, pre_brand, match_type, \
            b_cat1_id, b_cat1_name, cat1_id, \
            cat1_name = bReg.brand_recognition(line)
            if pre_brand != None and match_type != None:
                print("%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s" % ( pre_brand, product_id, product_name, cat1, cat2, \
                                                                  pre_brand_id, b_cat1_name, match_type))
            else:
                if match_type == None: match_type = '没有匹配到任何品牌'
                print("%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s" % ('', product_id, product_name, cat1, cat2, \
                                                          '', '', match_type))

        except Exception as e:
            print(traceback.format_exc())
    print(err_lst)


#a = bReg.english_brand_recognition("vero moda".lower(), "Vero Moda2020春季新款棉收腰宽摆风衣外套女 320121527 VERO MODA".lower())
#print(a)
